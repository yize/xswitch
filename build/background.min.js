/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/background.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/arrayWithoutHoles.js":
/***/ (function(module, exports) {

function _arrayWithoutHoles(arr) {
  if (Array.isArray(arr)) {
    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {
      arr2[i] = arr[i];
    }

    return arr2;
  }
}

module.exports = _arrayWithoutHoles;

/***/ }),

/***/ "./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/classCallCheck.js":
/***/ (function(module, exports) {

function _classCallCheck(instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
}

module.exports = _classCallCheck;

/***/ }),

/***/ "./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/createClass.js":
/***/ (function(module, exports) {

function _defineProperties(target, props) {
  for (var i = 0; i < props.length; i++) {
    var descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ("value" in descriptor) descriptor.writable = true;
    Object.defineProperty(target, descriptor.key, descriptor);
  }
}

function _createClass(Constructor, protoProps, staticProps) {
  if (protoProps) _defineProperties(Constructor.prototype, protoProps);
  if (staticProps) _defineProperties(Constructor, staticProps);
  return Constructor;
}

module.exports = _createClass;

/***/ }),

/***/ "./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/defineProperty.js":
/***/ (function(module, exports) {

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

module.exports = _defineProperty;

/***/ }),

/***/ "./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/iterableToArray.js":
/***/ (function(module, exports) {

function _iterableToArray(iter) {
  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter);
}

module.exports = _iterableToArray;

/***/ }),

/***/ "./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/nonIterableSpread.js":
/***/ (function(module, exports) {

function _nonIterableSpread() {
  throw new TypeError("Invalid attempt to spread non-iterable instance");
}

module.exports = _nonIterableSpread;

/***/ }),

/***/ "./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/objectSpread.js":
/***/ (function(module, exports, __webpack_require__) {

var defineProperty = __webpack_require__("./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/defineProperty.js");

function _objectSpread(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};
    var ownKeys = Object.keys(source);

    if (typeof Object.getOwnPropertySymbols === 'function') {
      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {
        return Object.getOwnPropertyDescriptor(source, sym).enumerable;
      }));
    }

    ownKeys.forEach(function (key) {
      defineProperty(target, key, source[key]);
    });
  }

  return target;
}

module.exports = _objectSpread;

/***/ }),

/***/ "./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/toConsumableArray.js":
/***/ (function(module, exports, __webpack_require__) {

var arrayWithoutHoles = __webpack_require__("./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/arrayWithoutHoles.js");

var iterableToArray = __webpack_require__("./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/iterableToArray.js");

var nonIterableSpread = __webpack_require__("./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/nonIterableSpread.js");

function _toConsumableArray(arr) {
  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();
}

module.exports = _toConsumableArray;

/***/ }),

/***/ "./src/background.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);

// EXTERNAL MODULE: ./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/toConsumableArray.js
var toConsumableArray = __webpack_require__("./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/toConsumableArray.js");
var toConsumableArray_default = /*#__PURE__*/__webpack_require__.n(toConsumableArray);

// EXTERNAL MODULE: ./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/objectSpread.js
var objectSpread = __webpack_require__("./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/objectSpread.js");
var objectSpread_default = /*#__PURE__*/__webpack_require__.n(objectSpread);

// EXTERNAL MODULE: ./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/defineProperty.js
var defineProperty = __webpack_require__("./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/defineProperty.js");
var defineProperty_default = /*#__PURE__*/__webpack_require__.n(defineProperty);

// EXTERNAL MODULE: ./src/constants.ts
var constants = __webpack_require__("./src/constants.ts");

// EXTERNAL MODULE: ./src/enums.ts
var enums = __webpack_require__("./src/enums.ts");

// EXTERNAL MODULE: ./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/classCallCheck.js
var classCallCheck = __webpack_require__("./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/classCallCheck.js");
var classCallCheck_default = /*#__PURE__*/__webpack_require__.n(classCallCheck);

// EXTERNAL MODULE: ./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/createClass.js
var createClass = __webpack_require__("./node_modules/_@babel_runtime@7.3.4@@babel/runtime/helpers/createClass.js");
var createClass_default = /*#__PURE__*/__webpack_require__.n(createClass);

// CONCATENATED MODULE: ./src/forward.ts





/**
 * get url type
 * @param url urls
 * @param reg rule
 */

var forward_matchUrl = function matchUrl(url, reg) {
  if (constants["J" /* REG */].FORWARD.test(reg)) {
    // support ??
    var r = new RegExp(reg.replace('??', '\\?\\?'), 'i');
    var matched = r.test(url);

    if (matched) {
      return enums["d" /* UrlType */].REG;
    }
  } else {
    var _matched = url.indexOf(reg) > -1;

    if (_matched) {
      return enums["d" /* UrlType */].STRING;
    }
  }

  return false;
};

var forward_Forward =
/*#__PURE__*/
function () {
  function Forward() {
    classCallCheck_default()(this, Forward);

    this._lastRequestId = null;
    this._disabled = enums["b" /* Enabled */].YES;
    this._config = {};
    this._originRequest = new Map();
    this._originRequestHeaders = new Map();
    this._urls = new Array(200); // for cache
  }

  createClass_default()(Forward, [{
    key: "onHeadersReceivedCallback",
    // Breaking the CORS Limitation
    value: function onHeadersReceivedCallback(details) {
      var cors = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
      // has cors rules
      var corsMap = this.config.cors;
      var corsMatched = false;

      if (corsMap && corsMap.length) {
        corsMap.forEach(function (rule) {
          if (forward_matchUrl(details.url, rule)) {
            corsMatched = true;
          }
        });
      }

      var disabled = this.disabled === enums["b" /* Enabled */].NO || !cors || !corsMatched;

      if (disabled) {
        return {};
      }

      var originUrl = details.url;
      var resHeaders = [];
      var CORSOrigin = (this._originRequest.get(details.requestId) ? this._originRequest.get(details.requestId) : details.initiator) || constants["l" /* DEFAULT_CORS_ORIGIN */];

      if (details.responseHeaders && details.responseHeaders.filter) {
        var hasCredentials = false;
        var tempOrigin = constants["s" /* EMPTY_STRING */];
        resHeaders = details.responseHeaders.filter(function (responseHeader) {
          // Already has access-control-allow-origin headers
          if (constants["g" /* CORS */].ORIGIN === responseHeader.name.toLowerCase()) {
            tempOrigin = responseHeader.value;
          }

          if (constants["g" /* CORS */].CREDENTIALS === responseHeader.name.toLowerCase()) {
            hasCredentials = responseHeader.value;
          }

          if ([constants["g" /* CORS */].ORIGIN, constants["g" /* CORS */].CREDENTIALS, constants["g" /* CORS */].METHODS, constants["g" /* CORS */].HEADERS].indexOf(responseHeader.name.toLowerCase()) < 0) {
            return true;
          }

          return false;
        }); // only when hasCredentials

        if (hasCredentials) {
          CORSOrigin = tempOrigin;
        }
      } // suck point


      if (CORSOrigin === constants["l" /* DEFAULT_CORS_ORIGIN */] && this._originRequest.get(details.requestId) === constants["D" /* NULL_STRING */]) {
        CORSOrigin = constants["l" /* DEFAULT_CORS_ORIGIN */];
      }

      resHeaders.push({
        name: constants["g" /* CORS */].ORIGIN,
        value: CORSOrigin
      });
      resHeaders.push({
        name: constants["g" /* CORS */].CREDENTIALS,
        value: constants["j" /* DEFAULT_CORS_CREDENTIALS */]
      });
      resHeaders.push({
        name: constants["g" /* CORS */].METHODS,
        value: constants["k" /* DEFAULT_CORS_METHODS */]
      });
      var CORSHeader = constants["s" /* EMPTY_STRING */];

      if (this._originRequestHeaders.get(details.requestId)) {
        CORSHeader = ',' + this._originRequestHeaders.get(details.requestId);
      }

      resHeaders.push({
        name: constants["g" /* CORS */].HEADERS,
        value: constants["m" /* DEFAULT_CREDENTIALS_RESPONSE_HEADERS */] + CORSHeader
      });
      return {
        responseHeaders: resHeaders
      };
    }
  }, {
    key: "redirectToMatchingRule",
    value: function redirectToMatchingRule(details) {
      var rules = this.config.proxy;
      var redirectUrl = details.url; // in case of chrome-extension downtime

      if (!rules || !rules.length || constants["J" /* REG */].CHROME_EXTENSION.test(redirectUrl)) {
        return {};
      }

      if (/http(s?):\/\/.*\.(js|css|json|jsonp)/.test(redirectUrl) && this._urls.indexOf(redirectUrl) < 0) {
        this._urls.shift();

        this._urls.push(redirectUrl);
      }

      try {
        for (var i = 0; i < rules.length; i++) {
          var rule = rules[i];

          if (rule && rule[0] && typeof rule[1] === 'string') {
            var reg = rule[0];
            var matched = forward_matchUrl(redirectUrl, reg);

            if (details.requestId !== this._lastRequestId) {
              if (matched === enums["d" /* UrlType */].REG) {
                var r = new RegExp(reg.replace('??', '\\?\\?'), 'i');
                redirectUrl = redirectUrl.replace(r, rule[1]);
              } else if (matched === enums["d" /* UrlType */].STRING) {
                redirectUrl = redirectUrl.split(rule[0]).join(rule[1]);
              }
            }
          }
        }
      } catch (e) {
        console.error('rule match error', e);
      }

      this._lastRequestId = details.requestId;
      return redirectUrl === details.url ? {} : {
        redirectUrl: redirectUrl
      };
    }
  }, {
    key: "onBeforeSendHeadersCallback",
    value: function onBeforeSendHeadersCallback(details) {
      var headers = [];

      for (var i = 0; i < details.requestHeaders.length; ++i) {
        var requestName = details.requestHeaders[i].name.toLowerCase();

        if (requestName === constants["E" /* ORIGIN */]) {
          this._originRequest.set(details.requestId, details.requestHeaders[i].value);
        } else if (requestName === constants["a" /* ACCESS_CONTROL_REQUEST_HEADERS */] || constants["J" /* REG */].X_HEADER.test(requestName)) {
          headers.push(requestName);
        }
      }

      if (headers.length) {
        this._originRequestHeaders.set(details.requestId, headers.join(','));
      }

      return {
        requestHeaders: details.requestHeaders
      };
    }
  }, {
    key: "onBeforeRequestCallback",
    value: function onBeforeRequestCallback(details) {
      return this.redirectToMatchingRule(details);
    }
  }, {
    key: "urls",
    get: function get() {
      return this._urls;
    }
  }, {
    key: "disabled",
    get: function get() {
      return this._disabled;
    },
    set: function set(newValue) {
      this._disabled = newValue;
    }
  }, {
    key: "config",
    get: function get() {
      return this._config;
    },
    set: function set(newValue) {
      this._config = objectSpread_default()({}, newValue);
    }
  }]);

  return Forward;
}();

if (!window._forward) {
  window._forward = new forward_Forward();
}

/* harmony default export */ var forward = (window._forward);
// CONCATENATED MODULE: ./src/background.ts




var _, _2, _chrome$storage$sync$, _chrome$storage$sync$2;




var clearRunning = false;
var clearCacheEnabled = true;
var corsEnabled = true;
var parseError = false;
var jsonActiveKeys = ['0'];
var conf = {
  0: (_ = {}, defineProperty_default()(_, constants["I" /* PROXY_STORAGE_KEY */], []), defineProperty_default()(_, constants["i" /* CORS_STORAGE */], []), _)
};
chrome.storage.sync.get((_chrome$storage$sync$ = {}, defineProperty_default()(_chrome$storage$sync$, constants["w" /* JSON_CONFIG */], {
  0: (_2 = {}, defineProperty_default()(_2, constants["I" /* PROXY_STORAGE_KEY */], []), defineProperty_default()(_2, constants["i" /* CORS_STORAGE */], []), _2)
}), defineProperty_default()(_chrome$storage$sync$, constants["b" /* ACTIVE_KEYS */], ['0']), _chrome$storage$sync$), function (result) {
  jsonActiveKeys = result[constants["b" /* ACTIVE_KEYS */]];

  if (result && result[constants["w" /* JSON_CONFIG */]]) {
    conf = result[constants["w" /* JSON_CONFIG */]];
    var config = getActiveConfig(conf);
    forward[constants["w" /* JSON_CONFIG */]] = objectSpread_default()({}, config);
  } else {
    var _forward$JSON_CONFIG;

    forward[constants["w" /* JSON_CONFIG */]] = (_forward$JSON_CONFIG = {}, defineProperty_default()(_forward$JSON_CONFIG, constants["I" /* PROXY_STORAGE_KEY */], []), defineProperty_default()(_forward$JSON_CONFIG, constants["i" /* CORS_STORAGE */], []), _forward$JSON_CONFIG);
    parseError = false;
  }
});

function getActiveConfig(config) {
  var activeKeys = toConsumableArray_default()(jsonActiveKeys);

  var json = config['0'];
  activeKeys.forEach(function (key) {
    if (config[key] && key !== '0') {
      if (config[key][constants["I" /* PROXY_STORAGE_KEY */]]) {
        if (!json[constants["I" /* PROXY_STORAGE_KEY */]]) {
          json[constants["I" /* PROXY_STORAGE_KEY */]] = [];
        }

        json[constants["I" /* PROXY_STORAGE_KEY */]] = [].concat(toConsumableArray_default()(json[constants["I" /* PROXY_STORAGE_KEY */]]), toConsumableArray_default()(config[key][constants["I" /* PROXY_STORAGE_KEY */]]));
      }

      if (config[key][constants["i" /* CORS_STORAGE */]]) {
        if (!json[constants["i" /* CORS_STORAGE */]]) {
          json[constants["i" /* CORS_STORAGE */]] = [];
        }

        json[constants["i" /* CORS_STORAGE */]] = [].concat(toConsumableArray_default()(json[constants["i" /* CORS_STORAGE */]]), toConsumableArray_default()(config[key][constants["i" /* CORS_STORAGE */]]));
      }
    }
  });
  return json;
}

chrome.storage.sync.get((_chrome$storage$sync$2 = {}, defineProperty_default()(_chrome$storage$sync$2, constants["q" /* DISABLED */], enums["b" /* Enabled */].YES), defineProperty_default()(_chrome$storage$sync$2, constants["f" /* CLEAR_CACHE_ENABLED */], enums["b" /* Enabled */].YES), defineProperty_default()(_chrome$storage$sync$2, constants["h" /* CORS_ENABLED_STORAGE_KEY */], enums["b" /* Enabled */].YES), _chrome$storage$sync$2), function (result) {
  forward[constants["q" /* DISABLED */]] = result[constants["q" /* DISABLED */]];
  clearCacheEnabled = result[constants["f" /* CLEAR_CACHE_ENABLED */]] === enums["b" /* Enabled */].YES;
  corsEnabled = result[constants["h" /* CORS_ENABLED_STORAGE_KEY */]] === enums["b" /* Enabled */].YES;
  setIcon();
});
chrome.storage.onChanged.addListener(function (changes) {
  var _3;

  if (changes[constants["b" /* ACTIVE_KEYS */]]) {
    jsonActiveKeys = changes[constants["b" /* ACTIVE_KEYS */]].newValue;
  }

  if (changes[constants["w" /* JSON_CONFIG */]]) {
    var config = getActiveConfig(changes[constants["w" /* JSON_CONFIG */]].newValue);
    forward[constants["w" /* JSON_CONFIG */]] = objectSpread_default()({}, config);
  }

  if (changes[constants["q" /* DISABLED */]]) {
    forward[constants["q" /* DISABLED */]] = changes[constants["q" /* DISABLED */]].newValue;
  }

  if (changes[constants["f" /* CLEAR_CACHE_ENABLED */]]) {
    clearCacheEnabled = changes[constants["f" /* CLEAR_CACHE_ENABLED */]].newValue === enums["b" /* Enabled */].YES;
  }

  if (changes[constants["h" /* CORS_ENABLED_STORAGE_KEY */]]) {
    corsEnabled = changes[constants["h" /* CORS_ENABLED_STORAGE_KEY */]].newValue === enums["b" /* Enabled */].YES;
  }

  chrome.storage.sync.get(defineProperty_default()({}, constants["w" /* JSON_CONFIG */], {
    0: (_3 = {}, defineProperty_default()(_3, constants["I" /* PROXY_STORAGE_KEY */], []), defineProperty_default()(_3, constants["i" /* CORS_STORAGE */], []), _3)
  }), function (result) {
    if (result && result[constants["w" /* JSON_CONFIG */]]) {
      conf = result[constants["w" /* JSON_CONFIG */]];

      var _config = getActiveConfig(conf);

      forward[constants["w" /* JSON_CONFIG */]] = objectSpread_default()({}, _config);
    }

    setIcon();
  });
});
chrome.webRequest.onBeforeRequest.addListener(function (details) {
  if (forward[constants["q" /* DISABLED */]] !== enums["b" /* Enabled */].NO) {
    if (clearCacheEnabled) {
      clearCache();
    }

    return forward.onBeforeRequestCallback(details);
  }

  return {};
}, {
  urls: [constants["c" /* ALL_URLS */]]
}, [constants["e" /* BLOCKING */]]); // Breaking the CORS Limitation

chrome.webRequest.onHeadersReceived.addListener(headersReceivedListener, {
  urls: [constants["c" /* ALL_URLS */]]
}, [constants["e" /* BLOCKING */], constants["L" /* RESPONSE_HEADERS */]]);
chrome.webRequest.onBeforeSendHeaders.addListener(function (details) {
  return forward.onBeforeSendHeadersCallback(details);
}, {
  urls: [constants["c" /* ALL_URLS */]]
}, [constants["e" /* BLOCKING */], constants["K" /* REQUEST_HEADERS */]]);

function setBadgeAndBackgroundColor(text, color) {
  var _chrome = chrome,
      browserAction = _chrome.browserAction;
  browserAction.setBadgeText({
    text: constants["s" /* EMPTY_STRING */] + text
  });
  browserAction.setBadgeBackgroundColor({
    color: color
  });
}

function setIcon() {
  if (parseError) {
    setBadgeAndBackgroundColor(enums["a" /* BadgeText */].ERROR, enums["c" /* IconBackgroundColor */].ERROR);
    return;
  }

  if (forward[constants["q" /* DISABLED */]] !== enums["b" /* Enabled */].NO) {
    setBadgeAndBackgroundColor(forward[constants["w" /* JSON_CONFIG */]][constants["I" /* PROXY_STORAGE_KEY */]].length, enums["c" /* IconBackgroundColor */].ON);
  } else {
    setBadgeAndBackgroundColor(enums["a" /* BadgeText */].OFF, enums["c" /* IconBackgroundColor */].OFF);
    return;
  }
}

function headersReceivedListener(details) {
  return forward.onHeadersReceivedCallback(details, corsEnabled);
}

function clearCache() {
  if (!clearRunning) {
    clearRunning = true;
    var millisecondsPerWeek = constants["A" /* MILLISECONDS_PER_WEEK */];
    var oneWeekAgo = new Date().getTime() - millisecondsPerWeek;
    chrome.browsingData.removeCache({
      since: oneWeekAgo
    }, function () {
      clearRunning = false;
    });
  }
}

/***/ }),

/***/ "./src/constants.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "J", function() { return REG; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return ALL_URLS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return BLOCKING; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "K", function() { return REQUEST_HEADERS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "L", function() { return RESPONSE_HEADERS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "m", function() { return DEFAULT_CREDENTIALS_RESPONSE_HEADERS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "g", function() { return CORS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ACCESS_CONTROL_REQUEST_HEADERS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "l", function() { return DEFAULT_CORS_ORIGIN; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "k", function() { return DEFAULT_CORS_METHODS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "j", function() { return DEFAULT_CORS_CREDENTIALS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "E", function() { return ORIGIN; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "q", function() { return DISABLED; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "w", function() { return JSON_CONFIG; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "v", function() { return JSONC_CONFIG; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "r", function() { return EDITING_CONFIG_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "P", function() { return TAB_LIST; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return ACTIVE_KEYS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return CLEAR_CACHE_ENABLED; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "i", function() { return CORS_STORAGE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "h", function() { return CORS_ENABLED_STORAGE_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "I", function() { return PROXY_STORAGE_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "A", function() { return MILLISECONDS_PER_WEEK; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "M", function() { return RULE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "z", function() { return LANGUAGE_JSON; });
/* unused harmony export CHANGE */
/* unused harmony export DOM_CONTENT_LOADED */
/* unused harmony export SWITCH_DOM_ID */
/* unused harmony export SWITCH_INNER_DOM_ID */
/* unused harmony export SWITCH_AREA_DOM_ID */
/* unused harmony export NEW_TAB_DOM_ID */
/* unused harmony export OPEN_README_DOM_ID */
/* unused harmony export CONTAINER_DOM_ID */
/* unused harmony export STATUS_DOM_ID */
/* unused harmony export CLEAR_CACHE_ENABLED_DOM_ID */
/* unused harmony export CORS_ENABLED_DOM_ID */
/* unused harmony export SWITCH_CHECKED_CLASSNAME */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "G", function() { return POPUP_HTML_PATH; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "H", function() { return PREFIX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "C", function() { return MONACO_VS_PATH; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "B", function() { return MONACO_CONTRIBUTION_PATH; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "u", function() { return HELP_URL; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "p", function() { return DEFAULT_FONT_FAMILY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "F", function() { return PLATFORM_MAC; });
/* unused harmony export OPTIONS_SAVED */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "s", function() { return EMPTY_STRING; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "y", function() { return KEY_DOWN; });
/* unused harmony export CLICK */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return ANYTHING; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "t", function() { return FORMAT_DOCUMENT_CMD; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "x", function() { return KEY_CODE_S; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "O", function() { return SHOW_FOLDING_CONTROLS; });
/* unused harmony export OPACITY_VISIBLE */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "D", function() { return NULL_STRING; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "N", function() { return RULE_COMPLETION; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "n", function() { return DEFAULT_DATA; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "o", function() { return DEFAULT_DUP_DATA; });
var REG = {
  TRIM_JSON: /(,+)([^a-z0-9["])/gi,
  CHROME_EXTENSION: /^chrome-extension:\/\//i,
  // support [ ] ( ) \ * ^ $
  FORWARD: /\\|\[|]|\(|\)|\*|\$|\^/i,
  WHITESPACE: /\s+/g,
  X_HEADER: /^x-/
};
var ALL_URLS = '<all_urls>';
var BLOCKING = 'blocking';
var REQUEST_HEADERS = 'requestHeaders';
var RESPONSE_HEADERS = 'responseHeaders';
var DEFAULT_CREDENTIALS_RESPONSE_HEADERS = 'Content-Type, access-control-allow-headers, Authorization, X-Requested-With, X-Referer';
var CORS = {
  METHODS: 'access-control-allow-methods',
  CREDENTIALS: 'access-control-allow-credentials',
  ORIGIN: 'access-control-allow-origin',
  HEADERS: 'access-control-allow-headers'
};
var ACCESS_CONTROL_REQUEST_HEADERS = 'access-control-request-headers';
var DEFAULT_CORS_ORIGIN = '*';
var DEFAULT_CORS_METHODS = '*';
var DEFAULT_CORS_CREDENTIALS = 'true';
var ORIGIN = 'origin';
/**
 * Disabled storage key
 */

var DISABLED = 'disabled';
/**
 * pure JSON storage key
 */

var JSON_CONFIG = 'config';
/**
 * JSON with comments storage key
 */

var JSONC_CONFIG = 'config_for_shown';
var EDITING_CONFIG_KEY = 'config_editing_key';
var TAB_LIST = 'tab_list';
var ACTIVE_KEYS = 'active_keys';
var CLEAR_CACHE_ENABLED = 'clearCacheEnabled';
var CORS_STORAGE = 'cors';
var CORS_ENABLED_STORAGE_KEY = 'corsEnabled';
var PROXY_STORAGE_KEY = 'proxy';
var MILLISECONDS_PER_WEEK = 1000 * 60 * 60 * 24 * 7;
var RULE = 'rule';
var LANGUAGE_JSON = 'json';
var CHANGE = 'change';
var DOM_CONTENT_LOADED = 'DOMContentLoaded';
var SWITCH_DOM_ID = 'J_Switch';
var SWITCH_INNER_DOM_ID = 'J_SwitchInner';
var SWITCH_AREA_DOM_ID = 'J_SwitchArea';
var NEW_TAB_DOM_ID = 'J_OpenInNewTab';
var OPEN_README_DOM_ID = 'J_OpenReadme';
var CONTAINER_DOM_ID = 'J_Container';
var STATUS_DOM_ID = 'J_Status';
var CLEAR_CACHE_ENABLED_DOM_ID = 'J_ClearCacheEnabled';
var CORS_ENABLED_DOM_ID = 'J_CorsEnabled';
var SWITCH_CHECKED_CLASSNAME = 'ant-switch-checked';
var POPUP_HTML_PATH = 'XSwitch.html';
var PREFIX =  false ? undefined : './';
var MONACO_VS_PATH =  false ? undefined : './lib/monaco-editor/min/vs';
var MONACO_CONTRIBUTION_PATH = 'vs/language/json/monaco.contribution';
var HELP_URL = 'https://yuque.com/jiushen/blog/xswitch-readme';
var DEFAULT_FONT_FAMILY = 'Menlo, Monaco, "Courier New", monospace';
var PLATFORM_MAC = 'Mac';
var OPTIONS_SAVED = 'Options saved.';
var EMPTY_STRING = '';
var KEY_DOWN = 'keydown';
var CLICK = 'click';
var ANYTHING = 'anyString';
var FORMAT_DOCUMENT_CMD = 'editor.action.formatDocument';
var KEY_CODE_S = 83;
var SHOW_FOLDING_CONTROLS = 'always';
var OPACITY_VISIBLE = '1';
var NULL_STRING = 'null';
var RULE_COMPLETION = "[\n  \"${1:from}\",\n  \"${1:to}\",\n],";
var DEFAULT_DATA = "{\n  // Use IntelliSense to learn about possible links.\n  // Type `rule` to quick insert rule.\n  // \u8F93\u5165 rule \u6765\u5FEB\u901F\u63D2\u5165\u89C4\u5219\n  // For more information, visit: https://github.com/yize/xswitch\n  \"proxy\": [\n    [\n      \"https://unpkg.com/react@16.4.1/umd/react.production.min.js\",\n      \"https://unpkg.com/react@16.4.1/umd/react.development.js\"\n    ],\n    // `Command/Ctrl + click` to visit:\n    // https://unpkg.com/react@16.4.1/umd/react.production.min.js\n    // [\n      // \"(.*)/path1/path2/(.*)\", // https://www.sample.com/path1/path2/index.js\n      // \"http://127.0.0.1:3000/$2\", // http://127.0.0.1:3000/index.js\n    // ],\n  ],\n  // urls that want CORS\n  // \"cors\": [\n    // \"mocks.a.com\",\n    // \"mocks.b.com\"\n  // ]\n}\n";
var DEFAULT_DUP_DATA = "{\n  \"proxy\": [\n    [\n      \"(.*)/path1/path2/(.*)\", // https://www.sample.com/path1/path2/index.js\n      \"http://127.0.0.1:3000/$2\", // http://127.0.0.1:3000/index.js\n    ],\n  ],\n}\n";

/***/ }),

/***/ "./src/enums.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return UrlType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return Enabled; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return IconBackgroundColor; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return BadgeText; });
var UrlType;

(function (UrlType) {
  UrlType["REG"] = "reg";
  UrlType["STRING"] = "string";
})(UrlType || (UrlType = {}));

var Enabled;

(function (Enabled) {
  Enabled["YES"] = "enabled";
  Enabled["NO"] = "disabled";
})(Enabled || (Enabled = {}));

var IconBackgroundColor;

(function (IconBackgroundColor) {
  IconBackgroundColor["ON"] = "#1890ff";
  IconBackgroundColor["OFF"] = "#bfbfbf";
  IconBackgroundColor["ERROR"] = "#f5222d";
})(IconBackgroundColor || (IconBackgroundColor = {}));

var BadgeText;

(function (BadgeText) {
  BadgeText["ERROR"] = "Error";
  BadgeText["OFF"] = "OFF";
  BadgeText["ON"] = "ON";
})(BadgeText || (BadgeText = {}));

/***/ })

/******/ });
//# sourceMappingURL=background.min.js.map